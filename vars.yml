# =============================================================================
# LINUX HARDENED REPOSITORY - VARIABLES
# =============================================================================



#========================WARNING WARNING WARNING WARNING=======================
# This file will be deleted as the final part of the lockdown script.
# This is to prevent passwords accidentally being left in plain text.
#========================WARNING WARNING WARNING WARNING=======================





# --- EXECUTION SWITCHES (yes/no or true/false) --------------------------------
# This will create a logical volume, format it as XFS and mount it.
# Set to "yes" or "true" to run storage configuration (LVM + XFS + mount).
# Set to "no" or "false" if storage has already been configured.
# Setting to yes will require configuration of the STORAGE: DISKS section below.
configure_storage: yes

# This will create a local admin user with sudo permissions.
# If you choose to disable root, this script will lock down the root account. Without creating an admin user, the only way to administer
# the system afterwards will be to enter single user mode. Single user mode is a recovery mode 
# reached by configuring options in the boot menu(grub) via the console. This is arguably more secure
# but incredibly inconvnient for managing the system.
# Having an admin user simplifies system administration at the cost of additional minor security
# risks. Customers can therefore choose how they would prefer to manage the system.
# The most secure and recommended option is to set this value to no.
# Configuring to yes will require setting the admin's username and password in the SECURITY / ACCOUNTS section.
# This uses the serveradmin_name and serveradmin_password variables.
create_admin_user: yes

# Disable SSH? This will disble the SSH server and prevent it from starting again at boot.
# Disabling SSH makes a system more difficult to adminster as it will require console access
# However it reduces potential security exposure since there are fewer ways to access the system.
# The DISA_STIG security profile recommends that SSH is enabled. Veeam recommend SSH is disabled.
disable_ssh: yes

# Disable root account password?
# Disabling the root account password will mean that access to the root account is not possible
# (unless some other means has been configured) without using single user mode, which is a recovery
# mode accessed via the boot menu (grub). This is a highly inconvinient way to manage a system.
# Veeam recommend disabling the root account password.
disable_root: yes

# Create GRUB user and password. 
# GRUB is the linux boot loader. Without this set it is possible to gain access to
# root account of a system without any passwords via the console. Even if the root account
# has had the password disabled. 
# Setting yes will overwrite any existing settings that may have been configured.
# The script will try to detect existing settings and fail if they are detected. But it cannot be relied on.
# Configuring to yes will require setting the username and password in the SECURITY / ACCOUNTS section.
# This uses the grub_superuser_name and grub_superuser_password variables. 
# This is recommended to be set to yes.
create_grub: yes

# Enable FIPS mode? FIPS mode ensures that system cryptography only uses approved algorithms e.g AES, SHA-2, RSA, ECDSA are used.
# Non compliant algoriths (e.g MD5, RC4 etc) will be disabled or rejected. This may cause incompatibilities if applications use non-compliant algorithms.
# Once enabled, FIPS cannot be disabled without leaving the system in an inconsistent configuration.
# If it needs to be disabled it is easier to reinstall and reconfigure the OS.
# FIPS mode is only supported on RHEL. It may work on Linux distributions
# in the Red Hat family, but isnt "technically" compliant since they dont inherit RHEL's certifications
# Enabling FIPS mode is recommended.
enable_FIPS: yes

# Set max usernamespaces to 0? This will prohibit a machine from running containers
# If a machine needs to run containers this should be set to no.
# It is recommended to set this to yes.
user_namespaces: yes

# Configure NTP to use only the server directive not pools?
# DISA STIG requires that NTP is configured using only specific servers. Not pools of servers.
# Setting this to yes will overwrite any existing configurations. 
# If set to yes then hostnames must be provided in the NTP CONFIGURATION section below. Multiple servers can be provided
# and they will be configured explicitly with the server directive. 
setup_ntp: yes

# Set up SSSD?
# SSSD validates user certificates from AD/LDAP.
# If not configured this will show as a fail in the DISA STIG report regardless of AD/LDAP integration. 
# It is recommended that customers do not integrate AD/LDAP with this server.
# Customers should therefore be given the option to configure this and understand that a fail is expected
# if not integrating with AD/LDAP. 
# Setting to yes will require completion of the SSSD Configuration section below.
setup_SSSD: yes

# --- STORAGE: DISKS ----------------------------------------------------------
# List block devices to use for the volume group (uncomment as needed, just delete the # as spacing is important in this file).
vol_disks:
#  - /dev/nvme0n1
#  - /dev/nvme1n1
#  - /dev/nvme2n1
#  - /dev/sda
  - /dev/sdb
#  - /dev/sdc
#  - /dev/vda
#  - /dev/vdb
#  - /dev/vdc
#  - /dev/mapper/mpatha
#  - /dev/mapper/mpathb
#  - /dev/mapper/mpathc

# Total LV size. Examples: "500g", "100%FREE".
# Can be larger than a single disk if given multiple disks (LVM spans PVs).
lvm_size: 25g
# Logical volume name.
vol_name: veeamvol
# Mount point for the filesystem.
vol_mount_point: /mnt/backupdata
# Volume group (LVM) name.
lvm_name: veeamlvm




# --- SECURITY / ACCOUNTS -----------------------------------------------------
# Service account name to be used.
veeam_user: vadmin
# Default Veeam user password.
veeam_user_password: 1234!
# Username for the local server admin account - with sudo.
serveradmin_name: serveradmin
# Password for the admin account.
serveradmin_password: 1234!
# Create a user for the bootloader - cannot be common names like root, admin, administrator
grub_superuser_name: grubuser
# Create a password for the bootloader user
grub_superuser_password: 1234!




# --- NTP CONFIGURATION -------------------------------------------------------
# DISA STIG requires specifying NTP servers specifically rather than pools
# list server names below
ntp_hostnames:
  - time.nist.gov
#  - time.google.com
#  - foo.example.com


# --- NAMING DEFAULTS ---------------------------------------------------------


# --- COMPLIANCE / SCAP REPORTING --------------------------------------------
# Path to SSG content (datastreams).
ssg_dir: /usr/share/xml/scap/ssg/content
# DISA STIG profile ID.
ssg_profile: xccdf_org.ssgproject.content_profile_stig
# Filenames for pre/post scan results and reports.
results_file: checkpoint_STIG_scan_results.xml
remediation_file: DISA_STIG_remediations.yml
report_file: checkpoint_STIG_compliance_report.html
post_fix_results_file: post_harden_STIG_scan_results.xml
post_fix_report_file: "{{ [playbook_dir, 'reports', 'post_hardening_STIG_compliance_report.html'] | path_join }}"
pre_fix_results_file: pre_harden_STIG_scan_results.xml
pre_fix_report_file: "{{ [playbook_dir, 'reports', 'pre_hardening_STIG_compliance_report.html'] | path_join }}"
